import{r as n,w as v,j as e}from"./index-v6CNqsEH.js";const A=()=>{const[u,x]=n.useState([]),{user:i,isAdmin:g}=v(),[c,N]=n.useState(""),[m,f]=n.useState("All"),[d,h]=n.useState(!0),[p,b]=n.useState(!1);n.useEffect(()=>{j()},[p]);const j=async()=>{try{if(h(!0),p){let s=[];!g&&i&&(s=s.filter(t=>t.owner_id===i.id)),x(s)}else{if(!i){x([]),h(!1);return}const s="https://ztubrfjqsckplmelezws.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp0dWJyZmpxc2NrcGxtZWxlendzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzMDQ5NjcsImV4cCI6MjA2NTg4MDk2N30.qyjJEwQKzk6t0tdSmRYZghBG1GMAE-2Y4g3obbwblr0";let l=`${s}/rest/v1/pets?select=*`;g||(l+=`&owner_id=eq.${i.id}`);const a=await fetch(l,{headers:{apikey:t,Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error(`Failed to fetch pets: ${a.status}`);const r=await a.json();x(r)}}catch(s){console.error("❌ Error loading pets:",s)}finally{h(!1)}},w=s=>{const t=new Date,l=new Date(s);let a=t.getFullYear()-l.getFullYear();const r=t.getMonth()-l.getMonth();if((r<0||r===0&&t.getDate()<l.getDate())&&a--,a<1){const y=(t.getFullYear()-l.getFullYear())*12+(t.getMonth()-l.getMonth());return y===1?"1 month":`${y} months`}else return a===1?"1 year":`${a} years`},o=u.filter(s=>{var a,r;const t=s.name.toLowerCase().includes(c.toLowerCase())||((a=s.owner_name)==null?void 0:a.toLowerCase().includes(c.toLowerCase()))||!1||((r=s.breed)==null?void 0:r.toLowerCase().includes(c.toLowerCase()))||!1||s.id.toLowerCase().includes(c.toLowerCase()),l=m==="All"||s.type===m.toLowerCase();return t&&l});return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Pets Registry"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("label",{className:"flex items-center gap-1 text-sm",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:()=>b(s=>!s)}),"Use LocalStorage"]}),e.jsx("button",{onClick:j,disabled:d,className:"px-4 py-2 text-sm bg-blue-50 text-blue-600 rounded-md hover:bg-blue-100 disabled:opacity-50",children:d?"Loading...":"Refresh"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-grow",children:e.jsx("input",{type:"text",placeholder:"Search pets...",className:"w-full px-4 py-2 border rounded-md",value:c,onChange:s=>N(s.target.value)})}),e.jsxs("select",{className:"px-3 py-2 border rounded-md",value:m,onChange:s=>f(s.target.value),children:[e.jsx("option",{value:"All",children:"All Species"}),e.jsx("option",{value:"Dog",children:"Dogs"}),e.jsx("option",{value:"Cat",children:"Cats"}),e.jsx("option",{value:"Bird",children:"Birds"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsx("div",{className:"border rounded-md overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Species"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Breed"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Age"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Owner"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Actions"})]})}),e.jsxs("tbody",{children:[d?Array.from({length:5}).map((s,t)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-16"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-20"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-12"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-24"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-16"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-20"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-8"})})]},t)):o.map(s=>e.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:s.id}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:s.name}),e.jsx("td",{className:"px-4 py-3 text-sm capitalize",children:s.type}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.breed||"N/A"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:w(s.birth_date)}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{children:[e.jsx("div",{children:s.owner_name||"Unknown"}),e.jsx("div",{className:"text-gray-500 text-xs",children:s.owner_email||""})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:"Edit"})})]},s.id)),!d&&o.length===0&&e.jsx("tr",{className:"border-t",children:e.jsx("td",{colSpan:7,className:"text-center py-8 text-gray-500",children:"No pets found"})})]})]})}),!d&&o.length>0&&e.jsxs("div",{className:"text-sm text-gray-500 text-center",children:["Showing ",o.length," of ",u.length," pets"]})]})};export{A as default};
